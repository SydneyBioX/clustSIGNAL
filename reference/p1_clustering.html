<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Initial non-spatial clustering — p1_clustering • clustSIGNAL</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Initial non-spatial clustering — p1_clustering"><meta name="description" content="A function to perform initial non-spatial clustering and sub-clustering of
normalised gene expression to generate 'initial clusters' and 'initial
subclusters'."><meta property="og:description" content="A function to perform initial non-spatial clustering and sub-clustering of
normalised gene expression to generate 'initial clusters' and 'initial
subclusters'."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">clustSIGNAL</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/clustSIGNAL.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sydneybiox/clustSIGNAL/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Initial non-spatial clustering</h1>
      <small class="dont-index">Source: <a href="https://github.com/sydneybiox/clustSIGNAL/blob/main/R/initClustering.R" class="external-link"><code>R/initClustering.R</code></a></small>
      <div class="d-none name"><code>p1_clustering.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function to perform initial non-spatial clustering and sub-clustering of
normalised gene expression to generate 'initial clusters' and 'initial
subclusters'.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">p1_clustering</span><span class="op">(</span></span>
<span>  <span class="va">spe</span>,</span>
<span>  dimRed <span class="op">=</span> <span class="st">"None"</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  batch_by <span class="op">=</span> <span class="st">"None"</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  clustParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>clust_c <span class="op">=</span> <span class="fl">0</span>, subclust_c <span class="op">=</span> <span class="fl">0</span>, iter.max <span class="op">=</span> <span class="fl">30</span>, k <span class="op">=</span> <span class="fl">10</span>, cluster.fun <span class="op">=</span></span>
<span>    <span class="st">"louvain"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-spe">spe<a class="anchor" aria-label="anchor" href="#arg-spe"></a></dt>
<dd><p>a SpatialExperiment object containing spatial coordinates in
'spatialCoords' matrix and normalised gene expression in 'logcounts' assay.</p></dd>


<dt id="arg-dimred">dimRed<a class="anchor" aria-label="anchor" href="#arg-dimred"></a></dt>
<dd><p>a character indicating the name of the reduced dimensions to
use from the SpatialExperiment object (i.e., from reducedDimNames(spe)).
Default value is 'None'.</p></dd>


<dt id="arg-batch">batch<a class="anchor" aria-label="anchor" href="#arg-batch"></a></dt>
<dd><p>a logical parameter for whether to perform batch correction.
Default value is FALSE.</p></dd>


<dt id="arg-batch-by">batch_by<a class="anchor" aria-label="anchor" href="#arg-batch-by"></a></dt>
<dd><p>a character indicating name of colData(spe) column containing
the batch names. Default value is 'None'.</p></dd>


<dt id="arg-threads">threads<a class="anchor" aria-label="anchor" href="#arg-threads"></a></dt>
<dd><p>a numeric value for the number of CPU cores to be used for the
analysis. Default value set to 1.</p></dd>


<dt id="arg-clustparams">clustParams<a class="anchor" aria-label="anchor" href="#arg-clustparams"></a></dt>
<dd><p>a list of parameters for TwoStepParam clustering methods:
clust_c is the number of centers to use for clustering with KmeansParam. By
default set to 0, in which case the method uses either 5000 centers or 1/5th
of the total cells in the data as the number of centers, whichever is lower.
subclust_c is the number of centers to use for sub-clustering the initial
clusters with KmeansParam. The default value is 0, in which case the method
uses either 1 center or half of the total cells in the initial cluster as
the number of centers, whichever is higher.
iter.max is the maximum number of iterations to perform during clustering
and sub-clustering with KmeansParam. Default value is 30.
k is a numeric value indicating the k-value used for clustering and
sub-clustering with NNGraphParam. Default value is 10.
cluster.fun is a character indicating the graph clustering method used with
NNGraphParam. By default, the Louvain method is used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>SpatialExperiment object with initial cluster and subcluster labels
of each cell.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ClustSignal_example</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu">clustSIGNAL</span><span class="fu">::</span><span class="fu">p1_clustering</span><span class="op">(</span><span class="va">spe</span>, dimRed <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Initial nonspatial clustering performed. Clusters = 4 Time 01:12:29"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nonspatial subclustering performed. Subclusters = 12 Time 01:12:29"</span>
<span class="r-in"><span><span class="va">spe</span><span class="op">$</span><span class="va">nsCluster</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span><span class="va">spe</span><span class="op">$</span><span class="va">initCluster</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 2 3 2 2 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: 1 2 3 4</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pratibha Panwar, Boyi Guo, Haowen Zhao, Stephanie Hicks, Shila Ghazanfar.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

